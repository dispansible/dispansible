#!/bin/bash

export ANSIBLE_NOCOWS=1

OS=linux
ASK_SUDO_PASS=''
TAGS=$1

if [ "$TAGS" == "" ]; then
  TAGS=all
fi

OS_FAMILY=`uname -s`
if [ "$OS_FAMILY" == "Darwin" ]; then
  OS=macosx
#  ASK_SUDO_PASS='--ask-sudo-pass'
fi

cd ansible

ansible-playbook\
 $ASK_SUDO_PASS\
 -v\
 --sudo --sudo-user=$USER\
 --connection=local\
 --extra-vars=os=$OS\
 --extra-vars='@../settings.yml'\
 --inventory-file=inventories/$OS\
 --module-path=library\
 --tags=$TAGS\
 playbook.yml
